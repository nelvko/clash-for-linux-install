# Linux ä¸€é”®å®‰è£… Clash

å› ä¸ºæœ‰åœ¨æœåŠ¡å™¨ä¸Šä½¿ç”¨ä»£ç†çš„éœ€æ±‚ï¼Œè¯•è¿‡å¤§éƒ¨åˆ†çš„å¼€æºè„šæœ¬ï¼Œæ€»æ˜¯é‡åˆ°å„ç§é—®é¢˜ã€‚äºæ˜¯è‡ªå·±åŠ¨æ‰‹ï¼Œä¸°è¡£è¶³é£Ÿã€‚å¯¹å®‰è£…è¿‡ç¨‹åŠåç»­ä½¿ç”¨è¿›è¡Œäº†å‹å¥½å°è£…ï¼Œéƒ¨ç½²ä½¿ç”¨èµ·æ¥ä¼˜é›…ã€ç®€å•ã€æ˜ç¡®ã€‚

åŸºäº `Clash` é¡¹ç›®ä½œè€…åˆ åº“å‰æœ€æ–°çš„ `Premium` ç‰ˆæœ¬ï¼Œå¦‚æœ‰éœ€æ±‚å¯è‡ªè¡Œæ›´æ¢ç‰ˆæœ¬ã€‚

æ–‡æœ«[å¼•ç”¨](#å¼•ç”¨)ä¸­æ”¶é›†äº†å„ç§å†…æ ¸å’Œ `GUI` å®¢æˆ·ç«¯ç‰ˆæœ¬çš„ä¸‹è½½åœ°å€ã€‚

![preview](resource/preview.png)

## ç¯å¢ƒè¦æ±‚

- éœ€è¦ `root` æˆ– `sudo` æƒé™ã€‚
- å…·å¤‡ `bash` å’Œ `systemd` çš„ç³»ç»Ÿç¯å¢ƒã€‚
- å·²é€‚é…ï¼š`CentOS 7.x`ã€`Debian 12.x`ã€`Ubuntu 24.x`ã€‚

## å¿«é€Ÿå¼€å§‹

### ä¸€é”®å®‰è£…è„šæœ¬

> [!NOTE]
>
> [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

```bash
git clone https://ghp.ci/https://github.com/nelvko/clash-for-linux-install.git && cd clash-for-linux-install && sudo bash -c '. install.sh; exec bash'
```

- ä¸Šè¿°è„šæœ¬å·²ä½¿ç”¨[ä»£ç†åŠ é€Ÿä¸‹è½½](https://ghp.ci/)ï¼Œå¦‚å¤±æ•ˆè¯·è‡ªè¡Œæ›´æ¢ã€‚

- ~~ä¸æ‡‚ä»€ä¹ˆæ˜¯è®¢é˜…é“¾æ¥çš„å°ç™½å¯å‚è€ƒ~~ï¼š[issue#1](https://github.com/nelvko/clash-for-linux-install/issues/1)

- æ²¡æœ‰è®¢é˜…ï¼Ÿ[click me](https://æ¬¡å…ƒ.net/auth/register?code=oUbI)

### Command

ä»¥ä¸‹å‘½ä»¤å·²é›†æˆåˆ°å…¨å±€é…ç½®æ–‡ä»¶ `bashrc` ä¸­ï¼Œå¯ç›´æ¥åœ¨ç»ˆç«¯æ‰§è¡Œã€‚

```bash
$ clashoff
ğŸ˜¼ å·²å…³é—­ä»£ç†ç¯å¢ƒ

$ clashon
ğŸ˜¼ å·²å¼€å¯ä»£ç†ç¯å¢ƒ

$ clashui
ğŸ˜¼ Web é¢æ¿åœ°å€...
```

- ä½¿ç”¨ `systemctl` æ§åˆ¶ `clash` å¯åœåï¼Œè¿˜éœ€è°ƒæ•´ä»£ç†ç¯å¢ƒå˜é‡çš„å€¼ï¼ˆhttp_proxy ç­‰ï¼‰ã€‚å› ä¸ºåº”ç”¨ç¨‹åºåœ¨å‘èµ·ç½‘ç»œè¯·æ±‚æ—¶ï¼Œä¼šé€šè¿‡å…¶æŒ‡å®šçš„ä»£ç†è½¬å‘æµé‡ã€‚
- ä»¥ä¸Šå‘½ä»¤é›†æˆäº†ä¸Šè¿°æµç¨‹ã€‚

### å®šæ—¶æ›´æ–°é…ç½®

```bash
# todo å®‰è£…æ—¶å­˜åˆ°æ–‡ä»¶ï¼Œåç»­å‘½ä»¤ç›´æ¥ç”¨
$ clashctl update [url]
ğŸ˜¼ é…ç½®æ›´æ–°æˆåŠŸï¼Œå·²é‡å¯ç”Ÿæ•ˆ

$ clashctl update --auto [url]
ğŸ˜¼ å®šæ—¶ä»»åŠ¡è®¾ç½®æˆåŠŸ

$ clashctl update log
âœ… 2024-12-13 23:38:56 é…ç½®æ›´æ–°æˆåŠŸ auto
```

- ä¸æŒ‡å®š `url` é»˜è®¤ä½¿ç”¨å®‰è£…æ—¶çš„è®¢é˜…ã€‚
- æ‰§è¡Œä¸€æ¬¡å³å¯ï¼Œä¼šæ–°å»ºå®šæ—¶ä»»åŠ¡ï¼Œæ¯ä¸¤å¤©è‡ªåŠ¨ä¸‹è½½å¹¶è¦†ç›–åŸé…ç½®æ–‡ä»¶ã€‚
- å¯é€šè¿‡ `crontab -e` ä¿®æ”¹æ›´æ–°é¢‘ç‡åŠè®¢é˜…é“¾æ¥ã€‚

### Web æ§åˆ¶å°è®¾ç½®å¯†é’¥ï¼ˆæ¨èï¼‰

```bash
$ clashctl secret xxx
ğŸ˜¼ å¯†é’¥æ›´æ–°æˆåŠŸï¼Œå·²é‡å¯ç”Ÿæ•ˆ

$ clashctl secret 
ğŸ˜¼ å½“å‰å¯†é’¥ï¼šxxx
```

- å¯åŠ¨æ—¶æŒ‡å®šï¼Œä¼˜å…ˆçº§å¤§äºé…ç½®æ–‡ä»¶ï¼Œæ›´æ–°è®¢é˜…åä¸ä¼šä¸¢å¤±ã€‚
- å¯ä¿®æ”¹æ–‡ä»¶ `/etc/systemd/system/clash.service` æŒ‡å®šå…¶ä»–å¯åŠ¨å‚æ•°ã€‚

### `Tun` æ¨¡å¼

```bash
$ clashctl tun [on|off]
ğŸ˜¼ tun å·²å¼€å¯ï¼å…³é—­
```

- ä½œç”¨ï¼šæ¥ç®¡æ‰€æœ‰æµé‡ã€å¯ä»¥ `ping` å¤–ç½‘ã€
- https://www.clashverge.dev/guide/term.html#tun
- https://clash.wiki/premium/tun-device.html

- æ‹¦æˆªå’Œå¤„ç†æ‰€æœ‰æµé‡é‡å®šå‘åˆ°æœ¬åœ°çš„ä»£ç†ç¨‹åºï¼Œæ— éœ€é…ç½®ä»£ç†åœ°å€ã€‚

### `Mixin` é…ç½®

```bash
$ clashctl mixin
ğŸ˜¼ æŸ¥çœ‹ mixin é…ç½®

$ clashctl mixin -e
ğŸ˜¼ ç¼–è¾‘ mixin é…ç½®
```

æ€è·¯ï¼š

- æ··å…¥é…ç½®ï¼šmixin.yaml ï¼ˆmixin.d ç›®å½•ï¼Œå¤šä¸ªé…ç½®ï¼‰
- å¾ªç¯éå†æ··å…¥é…ç½®ï¼Œé€šè¿‡ sed å»æ‰ä¸»é…ç½®ä¸­å¯¹åº”çš„é…ç½®é¡¹
- `cat config.yaml mixin.yaml`

### å¸è½½

```bash
sudo bash -c '. uninstall.sh; exec bash'
```

## å¸¸è§é—®é¢˜

### ä¸‹è½½å¤±è´¥ã€é…ç½®æ— æ•ˆ

- ä¸‹è½½å¤±è´¥ï¼šè„šæœ¬ä½¿ç”¨ `wget`ã€`curl`
  å‘½ä»¤è¿›è¡Œäº†å¤šæ¬¡[é‡è¯•](https://github.com/nelvko/clash-for-linux-install/blob/035c85ac92166e95b7503b2a678a6b535fbd4449/script/common.sh#L32-L46)
  ä¸‹è½½ï¼Œå¦‚æœè¿˜æ˜¯å¤±è´¥å¯èƒ½æ˜¯æœºåœºé™åˆ¶ï¼Œè¯·è‡ªè¡Œç²˜è´´å†…å®¹åˆ°é…ç½®æ–‡ä»¶ï¼š[issue#1](https://github.com/nelvko/clash-for-linux-install/issues/1#issuecomment-2066334716)

- è®¢é˜…é…ç½®æ— æ•ˆï¼š[issue#14](https://github.com/nelvko/clash-for-linux-install/issues/14#issuecomment-2513303276)

### bash: clashon: command not found

- åŸå› ï¼šä½¿ç”¨ `bash install.sh` æ‰§è¡Œè„šæœ¬ä¸ä¼šå¯¹å½“å‰ `shell` ç”Ÿæ•ˆã€‚

- è§£å†³ï¼šå½“å‰ `shell` æ‰§è¡Œä¸‹ `bash`ã€‚

- <details>

  <summary>å‡ ç§è¿è¡Œæ–¹å¼çš„åŒºåˆ«ï¼š</summary>

    - `bash` å‘½ä»¤è¿è¡Œï¼šå½“å‰ `shell` å¼€å¯ä¸€ä¸ªå­ `shell` æ‰§è¡Œè„šæœ¬ï¼Œå¯¹ç¯å¢ƒçš„ä¿®æ”¹ä¸ä¼šä½œç”¨åˆ°å½“å‰ `shell`ï¼Œå› æ­¤ä¸å…·å¤‡ `clashon`
      ç­‰å‘½ä»¤ã€‚

      ```bash
      # éœ€è¦æœ‰å¯æ‰§è¡Œæƒé™
      $ ./install.sh
      # ä¸éœ€è¦å¯æ‰§è¡Œæƒé™ï¼Œéœ€è¦è¯»æƒé™
      $ bash ./install.sh
      ```

    - `shell` å†…å»ºå‘½ä»¤è¿è¡Œï¼šè„šæœ¬åœ¨å½“å‰ `shell` ç¯å¢ƒä¸­æ‰§è¡Œï¼Œå˜é‡å’Œå‡½æ•°çš„å®šä¹‰å¯¹å½“å‰ `shell` æœ‰æ•ˆï¼Œ`root` ç”¨æˆ·æ¨èè¿™ç§æ–¹å¼æ‰§è¡Œè„šæœ¬ã€‚

      ```bash
      # ä¸éœ€è¦å¯æ‰§è¡Œæƒé™ï¼Œéœ€è¦è¯»æƒé™
      $ . install.sh
      $ source uninstall.sh
      ```

  </details>

### æœåŠ¡å¯åŠ¨å¤±è´¥/æœªå¯åŠ¨

- [ç«¯å£å ç”¨](https://github.com/nelvko/clash-for-linux-install/issues/15#issuecomment-2507341281)
- [ç³»ç»Ÿä¸º WSL ç¯å¢ƒæˆ–ä¸å…·å¤‡ systemd](https://github.com/nelvko/clash-for-linux-install/issues/11#issuecomment-2469817217)

## å¼•ç”¨

- [clash-linux-amd64-v3-2023.08.17.gz](https://downloads.clash.wiki/ClashPremium/)
- [Clash Web Dashboard](https://github.com/haishanh/yacd/releases/tag/v0.3.8)
- [Clash å…¨å®¶æ¡¶ä¸‹è½½](https://www.clash.la/releases/)
- [Clash çŸ¥è¯†åº“](https://clash.wiki/)

## Todo

- [x] å®šæ—¶æ›´æ–°é…ç½®
- [x] ğŸ˜¼
- [x] é€‚é…å…¶ä»–å‘è¡Œç‰ˆ
- [x] é…ç½®æ›´æ–°æ—¥å¿—
- [ ] Tun æ¨¡å¼
- [ ] mixin é…ç½®
- [ ] [bug / éœ€æ±‚](https://github.com/nelvko/clash-for-linux-install/issues)

## Thanks

[@é‘«å“¥](https://github.com/TrackRay)

## ç‰¹åˆ«å£°æ˜

1. ç¼–å†™æœ¬é¡¹ç›®ä¸»è¦ç›®çš„ä¸ºå­¦ä¹ å’Œç ”ç©¶ `Shell` ç¼–ç¨‹ï¼Œä¸å¾—å°†æœ¬é¡¹ç›®ä¸­ä»»ä½•å†…å®¹ç”¨äºè¿åå›½å®¶/åœ°åŒº/ç»„ç»‡ç­‰çš„æ³•å¾‹æ³•è§„æˆ–ç›¸å…³è§„å®šçš„å…¶ä»–ç”¨é€”ã€‚

2. æœ¬é¡¹ç›®ä¿ç•™éšæ—¶å¯¹å…è´£å£°æ˜è¿›è¡Œè¡¥å……æˆ–æ›´æ”¹çš„æƒåˆ©ï¼Œç›´æ¥æˆ–é—´æ¥ä½¿ç”¨æœ¬é¡¹ç›®å†…å®¹çš„ä¸ªäººæˆ–ç»„ç»‡ï¼Œè§†ä¸ºæ¥å—æœ¬é¡¹ç›®çš„ç‰¹åˆ«å£°æ˜ã€‚
